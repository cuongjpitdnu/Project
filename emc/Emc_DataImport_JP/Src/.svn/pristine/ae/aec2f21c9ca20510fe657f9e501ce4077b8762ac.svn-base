<?php
    // -------------------------------------------------------------------------
    //	function	:
    //	create		: 2020/02/17 KBS Tamnv
    //	update		:
    // -------------------------------------------------------------------------

    require_once('common/common.php');
    // require_once('common/validate_user.php');

    header('Content-type: text/html; charset=utf-8');
    header('X-FRAME-OPTIONS: DENY');

    //セッションスタート

    if(fncConnectDB() == false){
        $_SESSION['LOGIN_ERROR'] = 'DB接続に失敗しました。';
        header('Location: login.php');
        exit;
    }

    if(!isset($_SESSION['LOGINUSER_INFO'])) {
        echo '<script>alert("'.PUBLIC_MSG_008_JPN.' / '.PUBLIC_MSG_008_ENG.'"); window.location.href="login.php";</script>';
        exit;
    }

    function fncGetInfoAnnounce($id) {
        try {
            $strSQL = ' SELECT * FROM t_announce WHERE t_announce.announce_no = ? ';
            $arrResult = fncSelectData($strSQL, array($id), 1, false, 'お知らせ表示画面');
            return $arrResult;
        } catch (\Exceoption $e) {
            fncWriteLog(LogLevel['Error'], LogPattern['Error'], $e->getMessage());
            return 0;
        }
    }

    if(isset($_POST)) {
        if(isset($_POST['action'])) {
            if($_POST['action'] == 'checkFile') {
                $filePath = SHARE_FOLDER.'/'.ANNOUNCE_ATTACHMENT_FOLDER.'/'.trim($_POST['file']);
                if(is_file($filePath)) {
                    echo $filePath;
                } else {
                    echo 0;
                }
            }
        }
    }
?>
